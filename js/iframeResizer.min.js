/*! iFrame Resizer (iframeSizer.min.js ) - v4.3.9 - 2024-02-20
 *  Desc: Force cross domain iframes to size to content.
 *  Requires: iframeResizer.contentWindow.min.js to be loaded into the target frame.
 *  Copyright: (c) 2024 David J. Bradshaw - dave@bradshaw.net
 *  License: MIT
 */
!function(s){if("undefined"!=typeof window){const C="message".length,W="[iFrameSizer]",H=W.length,g=Object.freeze({max:1,scroll:1,bodyScroll:1,documentElementScroll:1}),j={},h=Object.freeze({autoResize:!0,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:!0,inPageLinks:!1,enablePublicMethods:!0,heightCalculationMethod:"auto",id:"iFrameResizer",interval:32,log:!1,maxHeight:1/0,maxWidth:1/0,minHeight:0,minWidth:0,mouseEvents:!0,offsetHeight:0,offsetWidth:0,postMessageTarget:null,scrolling:!1,sizeHeight:!0,sizeWidth:!1,warningTimeout:5e3,tolerance:0,widthCalculationMethod:"scroll",onClose:()=>!0,onClosed(){},onInit:!1,onMessage:null,onMouseEnter(){},onMouseLeave(){},onReady(e){"function"==typeof j[e.id].onInit&&(k("onInit() function is deprecated and has been replaced with onReady()"),j[e.id].onInit(e))},onResized(){},onScroll:()=>!0});let d=0,l=!1,a=!1,v=null,t=null;const P=(e,n,t)=>e.addEventListener(n,t,!1),A=(e,n,t)=>e.removeEventListener(n,t,!1),p=e=>`${W}[${function(e){let n="Host page: "+e;window.top!==window.self&&(n=window?.parentIFrame?.getId?window.parentIFrame.getId()+": "+e:"Nested host page: "+e);return n}(e)}]`,w=e=>j[e]?j[e].log:l,b=e=>!Number.isNaN(e),L={};let e=!1;function i(e,n,t,...i){!0===t&&console[e](p(n),...i)}function I(e,...n){i("log",e,w(e),...n)}function x(e,...n){i("info",e,w(e),...n)}function k(e,...n){i("warn",e,!0,...n)}function n(e){function t(){n("Height"),n("Width"),E(function(){N(g),T(h),u("onResized",g)},g,"init")}function n(e){var n=Number(j[h]["max"+e]),t=Number(j[h]["min"+e]),e=e.toLowerCase();let i=Number(g[e]);I(h,`Checking ${e} is in range ${t}-`+n),i<t&&(i=t,I(h,`Set ${e} to min value`)),i>n&&(i=n,I(h,`Set ${e} to max value`)),g[e]=""+i}function i(){let t=e["origin"],i=j[h]?.checkOrigin;if(i&&""+t!="null"&&!function(){if(i.constructor!==Array)return e=j[h]?.remoteHost,I(h,"Checking connection is from: "+e),t===e;{let e=0,n=!1;for(I(h,"Checking connection is from allowed list of origins: "+i);e<i.length;e++)if(i[e]===t){n=!0;break}return n}var e}())throw new Error(`Unexpected message received from: ${t} for ${g.iframe.id}. Message was: ${e.data}. This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.`);return 1}function o(e){return m.slice(m.indexOf(":")+C+e)}function a(t){var e,n,i;e=function(){var e,n;O("Send Page Info","pageInfo:"+(e=document.body.getBoundingClientRect(),n=g.iframe.getBoundingClientRect(),JSON.stringify({documentHeight:document.documentElement.clientHeight,documentWidth:document.documentElement.clientWidth,iframeHeight:n.height,iframeWidth:n.width,offsetTop:parseInt(n.top-e.top,10),offsetLeft:parseInt(n.left-e.left,10),scrollX:window.scrollY,scrollY:window.scrollX,scrollTop:window.scrollY,scrollLeft:window.scrollX,windowHeight:window.innerHeight,windowWidth:window.innerWidth})),t)},n=32,i=t,L[i]||(L[i]=setTimeout(()=>{L[i]=null,e()},n))}function r(e){e=e.getBoundingClientRect();return F(h),{x:Math.floor(Number(e.left)+Number(v.x)),y:Math.floor(Number(e.top)+Number(v.y))}}function s(e){var n,t,i=e?r(g.iframe):{x:0,y:0};n=g,t=i;let o={x:Number(n.width)+t.x,y:Number(n.height)+t.y};I(h,`Reposition requested from iFrame (offset x:${i.x} y:${i.y})`),window.top===window.self?(v=o,d(),I(h,"--")):window.parentIFrame?window.parentIFrame["scrollTo"+(e?"Offset":"")](o.x,o.y):k(h,"Unable to scroll to requested position, window.parentIFrame not found")}function d(){!1===u("onScroll",v)?R():T(h)}function l(e){const n=e.split("#")[1]||"";var e=decodeURIComponent(n);let t=document.getElementById(e)||document.getElementsByName(e)[0];t?(e=r(t),I(h,`Moving to in page link (#${n}) at x: ${e.x} y: `+e.y),v={x:e.x,y:e.y},d(),I(h,"--")):window.top===window.self?I(h,`In page link #${n} not found`):window.parentIFrame?window.parentIFrame.moveToAnchor(n):I(h,`In page link #${n} not found and window.parentIFrame not found`)}function c(e){let n={};var t;n=0===Number(g.width)&&0===Number(g.height)?{x:(t=o(9).split(":"))[1],y:t[0]}:{x:g.width,y:g.height},u(e,{iframe:g.iframe,screenX:Number(n.x),screenY:Number(n.y),type:g.type})}const u=(e,n)=>M(h,e,n);function f(){switch(j[h]?.firstRun&&j[h]&&(j[h].firstRun=!1),g.type){case"close":$(g.iframe);break;case"message":n=o(6),I(h,`onMessage passed: {iframe: ${g.iframe.id}, message: ${n}}`),u("onMessage",{iframe:g.iframe,message:JSON.parse(n)}),I(h,"--");break;case"mouseenter":c("onMouseEnter");break;case"mouseleave":c("onMouseLeave");break;case"autoResize":j[h].autoResize=JSON.parse(o(9));break;case"scrollTo":s(!1);break;case"scrollToOffset":s(!0);break;case"pageInfo":a(h);{function e(n,t){function i(){j[o]?a(o):r()}["scroll","resize"].forEach(e=>{I(o,n+e+" listener for sendPageInfo"),t(window,e,i)})}function r(){e("Remove ",A)}let o=h;e("Add ",P),j[o]&&(j[o].stopPageInfo=r)}break;case"pageInfoStop":j[h]?.stopPageInfo&&(j[h].stopPageInfo(),delete j[h].stopPageInfo);break;case"inPageLink":l(o(9));break;case"reset":z(g);break;case"init":t(),u("onReady",g.iframe);break;default:0===Number(g.width)&&0===Number(g.height)?k(`Unsupported message received (${g.type}), this is likely due to the iframe containing a later `+"version of iframe-resizer than the parent page"):t()}var n}let m=e.data,g={},h=null;var p,w,b,y;"[iFrameResizerChild]Ready"===m?Object.keys(j).forEach(e=>O("iFrame requested init",S(e),e)):W===(""+m).slice(0,H)&&m.slice(H).split(":")[0]in j?(g=(p=m.slice(H).split(":"),w=p[1]?parseInt(p[1],10):0,y=j[p[0]]?.iframe,b=getComputedStyle(y),{iframe:y,id:p[0],height:w+function(e){if("border-box"!==e.boxSizing)return 0;var n=e.paddingTop?parseInt(e.paddingTop,10):0,e=e.paddingBottom?parseInt(e.paddingBottom,10):0;return n+e}(b)+function(e){if("border-box"!==e.boxSizing)return 0;var n=e.borderTopWidth?parseInt(e.borderTopWidth,10):0,e=e.borderBottomWidth?parseInt(e.borderBottomWidth,10):0;return n+e}(b),width:p[2],type:p[3]}),(h=g.id)?((y=g.type in{true:1,false:1,undefined:1})&&I(h,"Ignoring init message from meta parent page"),!y&&function(e){let n=!0;return j[e]||(n=!1,k(g.type+` No settings for ${e}. Message was: `+m)),n}(h)&&(I(h,"Received: "+m),j[h].loaded=!0,function(){let e=!0;return null===g.iframe&&(k(h,`IFrame (${g.id}) not found`),e=!1),e}())&&i()&&f()):k("iframeResizer received messageData without id")):x(h,"Ignored: "+m)}function M(e,n,t){var i=null;let o=null;if(j[e]){if("function"!=typeof(i=j[e][n]))throw new TypeError(n+` on iFrame[${e}] is not a function`);o=i(t)}return o}function c(e){e=e.id;delete j[e]}function $(e){var n=e.id;if(!1===M(n,"onClose",n))I(n,"Close iframe cancelled by onClose event");else{I(n,"Removing iFrame: "+n);try{e.parentNode&&e.remove()}catch(e){k(e)}M(n,"onClosed",n),I(n,"--"),c(e)}}function F(e){null===v&&I(e,`Get page position: ${(v={x:window.scrollX,y:window.scrollY}).x},`+v.y)}function R(){v=null}function T(e){null!==v&&(window.scrollTo(v.x,v.y),I(e,`Set page position: ${v.x},`+v.y),R())}function z(e){I(e.id,"Size reset requested by "+("init"===e.type?"host page":"iFrame")),F(e.id),E(function(){N(e),O("reset","reset",e.id)},e,"reset")}function N(i){const o=i.id;function r(e){function n(){Object.keys(j).forEach(function(n){var e=e=>"0px"===j[n]?.iframe.style[e];j[n]&&null!==j[n].iframe.offsetParent&&(e("height")||e("width"))&&O("Visibility change","resize",n)})}function t(e){I("window",`Mutation observed: ${e[0].target} `+e[0].type),u(n,16)}a||"0"!==i[e]||(a=!0,I(o,"Hidden iFrame detected, creating visibility listener"),e=document.querySelector("body"),new MutationObserver(t).observe(e,{attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0}))}function e(e){var n,t;t=i[n=e]+"px",i.iframe.style[n]=t,I(o,`IFrame (${o}) ${n} set to `+t),r(e)}j[o].sizeHeight&&e("height"),j[o].sizeWidth&&e("width")}function E(e,n,t){t!==n.type&&requestAnimationFrame&&!window.jasmine?(I(n.id,"Requesting animation frame"),requestAnimationFrame(e)):e()}function O(t,i,o,e){function n(){var e,n;j[o]?.postMessageTarget?({postMessageTarget:e,targetOrigin:n}=j[o],I(o,`[${t}] Sending message to iframe[${o}] (${i}) targetOrigin: `+n),e.postMessage(W+i,n)):k(o,`[${t}] IFrame(${o}) not found`)}function r(){e&&j[o]?.warningTimeout&&(j[o].msgTimeout=setTimeout(function(){j[o]?.loaded||a||j[o]!==s&&(a=!0,k(o,`IFrame has not responded within ${j[o].warningTimeout/1e3} seconds. Check iFrameResizer.contentWindow.js has been loaded in iFrame.`+" This message can be ignored if everything is working, or you can set the warningTimeout option to a higher value or zero to suppress this warning."))},j[o].warningTimeout))}let a=!1;j[o]&&(n(),r())}function S(e){var n=j[e];return[e,"8",n.sizeWidth,n.log,n.interval,n.enablePublicMethods,n.autoResize,n.bodyMargin,n.heightCalculationMethod,n.bodyBackground,n.bodyPadding,n.tolerance,n.inPageLinks,"child",n.widthCalculationMethod,n.mouseEvents,n.offsetHeight,n.offsetWidth].join(":")}function o(i,n){function e(t){var e;e=MutationObserver,i.parentNode&&new e(e=>{e.forEach(e=>{Array.prototype.slice.call(e.removedNodes).forEach(e=>{e===i&&$(i)})})}).observe(i.parentNode,{childList:!0}),P(i,"load",function(){var e,n;O("iFrame.onload",t,i.id,!0),e=j[o]?.firstRun,n=j[o]?.heightCalculationMethod in g,!e&&n&&z({iframe:i,height:0,width:0,type:"init"})}),O("init",t,i.id,!0)}function t(e){j[o]={iframe:i,firstRun:!0,remoteHost:i?.src.split("/").slice(0,3).join("/"),...h,...function(e){if(e&&"object"!=typeof e)throw new TypeError("Options is not an object");return e||{}}(e)},null===j[o].postMessageTarget&&(j[o].postMessageTarget=i.contentWindow),j[o]&&(j[o].targetOrigin=!0!==j[o].checkOrigin||""===(e=j[o].remoteHost)||null!==e.match(/^(about:blank|javascript:|file:\/\/)/)?"*":e)}const o=function(e){if("string"!=typeof e)throw new TypeError("Invaild id for iFrame. Expected String");return""===e&&(i.id=e=function(){let e=n?.id||h.id+d++;return null!==document.getElementById(e)&&(e+=d++),e}(),l=(n||{}).log,I(e,`Added missing iframe ID: ${e} (${i.src})`)),e}(i.id);if(o in j&&"iFrameResizer"in i)k(o,"Ignored iFrame, already setup.");else{switch(t(n),I(o,`IFrame scrolling ${j[o]?.scrolling?"enabled":"disabled"} for `+o),i.style.overflow=!1===j[o]?.scrolling?"hidden":"auto",j[o]?.scrolling){case"omit":break;case!0:i.scrolling="yes";break;case!1:i.scrolling="no";break;default:i.scrolling=j[o]?j[o].scrolling:"no"}s("Height"),s("Width"),a("maxHeight"),a("minHeight"),a("maxWidth"),a("minWidth"),"number"!=typeof(r=j[o].bodyMargin)&&"0"!==r||(j[o].bodyMargin=r+"px"),e(S(o)),j[o]&&(j[o].iframe.iFrameResizer={close:$.bind(null,j[o].iframe),removeListeners:c.bind(null,j[o].iframe),resize:O.bind(null,"Window resize","resize",o),moveToAnchor(e){O("Move to anchor","moveToAnchor:"+e,o)},sendMessage(e){O("Send Message","message:"+(e=JSON.stringify(e)),o)}})}var r;function a(e){var n=j[o][e];1/0!==n&&0!==n&&(i.style[e]=b(n)?n+"px":n,I(o,`Set ${e} = `+i.style[e]))}function s(e){if(b("min"+e)&&b("max"+e)&&j[o]["min"+e]>j[o]["max"+e])throw new Error(`Value for min${e} can not be greater than max`+e)}}function u(e,n){null===t&&(t=setTimeout(()=>{t=null,e()},n))}function r(){function e(){var t,i;t="Tab Visible",i="resize",Object.keys(j).forEach(function(e){var n;n=e,j[n]?.autoResize&&!j[n]?.firstRun&&O(t,i,e)})}"hidden"!==document.visibilityState&&(I("document","Trigger event: Visibility change"),u(e,16))}function f(){function t(e,n){if(n){if(!n.tagName)throw new TypeError("Object is not a valid DOM element");if("IFRAME"!==n.tagName.toUpperCase())throw new TypeError(`Expected <IFRAME> tag, found <${n.tagName}>`);o(n,e),i.push(n)}}let i;return e||(P(window,"message",n),P(document,"visibilitychange",r),e=!0),function(e,n){switch(i=[],typeof n){case"undefined":case"string":Array.prototype.forEach.call(document.querySelectorAll(n||"iframe"),t.bind(s,e));break;case"object":t(e,n);break;default:throw new TypeError(`Unexpected data type (${typeof n})`)}return i}}function m(e){e.fn?e.fn.iFrameResize||(e.fn.iFrameResize=function(t){return this.filter("iframe").each(function(e,n){o(n,t)}).end()}):x("","Unable to bind to jQuery, it is not fully loaded.")}window.jQuery!==s&&m(window.jQuery),"function"==typeof define&&define.amd&&define([],f),"object"==typeof module&&"object"==typeof module.exports&&(module.exports=f()),window.iFrameResize=window.iFrameResize||f()}}();
//# sourceMappingURL=iframeResizer.map