/*! iFrame Resizer (iframeSizer.min.js ) - v4.3.9 - 2024-02-25
 *  Desc: Force cross domain iframes to size to content.
 *  Requires: iframeResizer.contentWindow.min.js to be loaded into the target frame.
 *  Copyright: (c) 2024 David J. Bradshaw - dave@bradshaw.net
 *  License: MIT
 */
!function(s){if("undefined"==typeof window)return;const v="message".length,I="[iFrameSizer]",x=I.length,d=Object.freeze({max:1,scroll:1,bodyScroll:1,documentElementScroll:1}),k={},l=Object.freeze({autoResize:!0,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:!0,inPageLinks:!1,enablePublicMethods:!0,heightCalculationMethod:"auto",id:"iFrameResizer",log:!1,maxHeight:1/0,maxWidth:1/0,minHeight:0,minWidth:0,mouseEvents:!0,offsetHeight:0,offsetWidth:0,postMessageTarget:null,scrolling:!1,sizeHeight:!0,sizeWidth:!1,warningTimeout:5e3,tolerance:0,widthCalculationMethod:"scroll",onClose:()=>!0,onClosed(){},onInit:!1,onMessage:null,onMouseEnter(){},onMouseLeave(){},onReady(e){"function"==typeof k[e.id].onInit&&(T("onInit() function is deprecated and has been replaced with onReady()"),k[e.id].onInit(e))},onResized(){},onScroll:()=>!0});let c=0,u=!1,$=null;const z=(e,n,t)=>e.addEventListener(n,t,!1),R=(e,n,t)=>e.removeEventListener(n,t,!1),t=e=>k[e]?k[e].log:u;const i=e=>{return`${I}[${e=e,window.top===window.self?"Host page: "+e:window?.parentIFrame?.getId?window.parentIFrame.getId()+": "+e:"Nested host page: "+e}]`},o=(e,n,...t)=>console[e](i(n),...t),M=(e,...n)=>!0===t(e)?o("log",e,t(e),...n):null,F=(e,...n)=>o("info",e,t(e),...n),T=(e,...n)=>o("warn",e,!0,...n);function e(e){function a(){n("Height"),n("Width"),H(m),S(h),g("onResized",m)}function n(e){var n=Number(k[h]["max"+e]),t=Number(k[h]["min"+e]),e=e.toLowerCase();let i=Number(m[e]);M(h,`Checking ${e} is in range ${t}-`+n),i<t&&(i=t,M(h,`Set ${e} to min value`)),i>n&&(i=n,M(h,`Set ${e} to max value`)),m[e]=""+i}function t(){let t=e["origin"],i=k[h]?.checkOrigin;if(i&&""+t!="null"&&!function(){if(i.constructor!==Array)return e=k[h]?.remoteHost,M(h,"Checking connection is from: "+e),t===e;{let e=0,n=!1;for(M(h,"Checking connection is from allowed list of origins: "+i);e<i.length;e++)if(i[e]===t){n=!0;break}return n}var e}())throw new Error(`Unexpected message received from: ${t} for ${m.iframe.id}. Message was: ${e.data}. This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.`);return 1}function s(e){return o.slice(o.indexOf(":")+v+e)}const d=(e,n)=>{const t={};var i,o;i=function(){j(`Send Page Info (${e})`,"pageInfo:"+function(){var e=document.body.getBoundingClientRect(),n=m.iframe.getBoundingClientRect(),{outerHeight:t,outerWidth:i,scrollY:o,scrollX:r}=window,{scrollWidth:a,scrollHeight:s,clientHeight:d,clientWidth:l}=document.documentElement;return JSON.stringify({documentHeight:d,documentWidth:l,iframeHeight:n.height,iframeWidth:n.width,offsetTop:n.top-e.top,offsetLeft:n.left-e.left,scrollX:r,scrollY:o,scrollWidth:a,scrollHeight:s,windowHeight:t,windowWidth:i})}(),n)},o=n,t[o]||(i(),t[o]=requestAnimationFrame(()=>{t[o]=null}))};function r(e){e=e.getBoundingClientRect();return W(h),{x:Math.floor(Number(e.left)+Number($.x)),y:Math.floor(Number(e.top)+Number($.y))}}function l(e){var n,t,i=e?r(m.iframe):{x:0,y:0};n=m,t=i;let o={x:Number(n.width)+t.x,y:Number(n.height)+t.y};M(h,`Reposition requested from iFrame (offset x:${i.x} y:${i.y})`),window.top===window.self?($=o,c(),M(h,"--")):window.parentIFrame?window.parentIFrame["scrollTo"+(e?"Offset":"")](o.x,o.y):T(h,"Unable to scroll to requested position, window.parentIFrame not found")}function c(){!1===g("onScroll",$)?C():S(h)}function u(e){const n=e.split("#")[1]||"";var e=decodeURIComponent(n);let t=document.getElementById(e)||document.getElementsByName(e)[0];t?(e=r(t),M(h,`Moving to in page link (#${n}) at x: ${e.x} y: `+e.y),$={x:e.x,y:e.y},c(),M(h,"--")):window.top===window.self?M(h,`In page link #${n} not found`):window.parentIFrame?window.parentIFrame.moveToAnchor(n):M(h,`In page link #${n} not found and window.parentIFrame not found`)}function f(e){let n={};var t;n=0===Number(m.width)&&0===Number(m.height)?{x:(t=s(9).split(":"))[1],y:t[0]}:{x:m.width,y:m.height},g(e,{iframe:m.iframe,screenX:Number(n.x),screenY:Number(n.y),type:m.type})}const g=(e,n)=>N(h,e,n);function i(){switch(k[h]?.firstRun&&k[h]&&(k[h].firstRun=!1),m.type){case"close":E(m.iframe);break;case"message":t=s(6),M(h,`onMessage passed: {iframe: ${m.iframe.id}, message: ${t}}`),g("onMessage",{iframe:m.iframe,message:JSON.parse(t)}),M(h,"--");break;case"mouseenter":f("onMouseEnter");break;case"mouseleave":f("onMouseLeave");break;case"autoResize":k[h].autoResize=JSON.parse(s(9));break;case"scrollTo":l(!1);break;case"scrollToOffset":l(!0);break;case"pageInfo":d("start",h);{const i=e=>()=>{k[o]?d(e,o):n()};function e(e,n){M(o,e+" listeners for sendPageInfo"),n(window,"scroll",i("scroll")),n(window,"resize",i("resize window"))}function n(){e("Remove ",R),r.disconnect()}const o=h,r=new ResizeObserver(i("iframe observed"));e("Add ",z),r.observe(document.body,{attributes:!0,childList:!0,subtree:!0}),k[o]&&(k[o].stopPageInfo=n)}break;case"pageInfoStop":k[h]?.stopPageInfo&&(k[h].stopPageInfo(),delete k[h].stopPageInfo);break;case"inPageLink":u(s(9));break;case"reset":O(m);break;case"init":a(),g("onReady",m.iframe);break;default:return 0===m.width&&0===m.height?void T(`Unsupported message received (${m.type}), this is likely due to the iframe containing a later `+"version of iframe-resizer than the parent page"):0===m.width||0===m.height?void M(h,"Ignoring message with 0 height or width"):document.hidden?void M(h,"Page hidden - ignored resize request"):void a()}var t}let o=e.data,m={},h=null;var p,w,b,y;"[iFrameResizerChild]Ready"===o?Object.keys(k).forEach(e=>j("iFrame requested init",P(e),e)):I===(""+o).slice(0,x)&&o.slice(x).split(":")[0]in k?(m=(p=o.slice(x).split(":"),w=p[1]?Number(p[1]):0,y=k[p[0]]?.iframe,b=getComputedStyle(y),{iframe:y,id:p[0],height:w+("border-box"!==(y=b).boxSizing?0:(y.paddingTop?parseInt(y.paddingTop,10):0)+(y.paddingBottom?parseInt(y.paddingBottom,10):0))+("border-box"!==(w=b).boxSizing?0:(w.borderTopWidth?parseInt(w.borderTopWidth,10):0)+(w.borderBottomWidth?parseInt(w.borderBottomWidth,10):0)),width:Number(p[2]),type:p[3]}),(h=m.id)?((y=m.type in{true:1,false:1,undefined:1})&&M(h,"Ignoring init message from meta parent page"),!y&&function(e){let n=!0;return k[e]||(n=!1,T(m.type+` No settings for ${e}. Message was: `+o)),n}(h)&&(M(h,"Received: "+o),k[h].loaded=!0,function(){let e=!0;return null===m.iframe&&(T(h,`IFrame (${m.id}) not found`),e=!1),e}())&&t()&&i()):T("iframeResizer received messageData without id")):F(h,"Ignored: "+o)}function N(e,n,t){var i=null;let o=null;if(k[e]){if("function"!=typeof(i=k[e][n]))throw new TypeError(n+` on iFrame[${e}] is not a function`);o=i(t)}return o}function f(e){e=e.id;delete k[e]}function E(e){var n=e.id;if(!1===N(n,"onClose",n))M(n,"Close iframe cancelled by onClose event");else{M(n,"Removing iFrame: "+n);try{e.parentNode&&e.remove()}catch(e){T(e)}N(n,"onClosed",n),M(n,"--"),f(e)}}function W(e){null===$&&($={x:window.scrollX,y:window.scrollY},M(e,`Get page position: ${$.x},`+$.y))}function C(){$=null}function S(e){null!==$&&(window.scrollTo($.x,$.y),M(e,`Set page position: ${$.x},`+$.y),C())}function O(e){M(e.id,"Size reset requested by "+("init"===e.type?"host page":"iFrame")),W(e.id),H(e),j("reset","reset",e.id)}function H(t){const i=t.id;function e(e){var n=t[e]+"px";t.iframe.style[e]=n,M(i,`IFrame (${i}) ${e} set to `+n)}k[i].sizeHeight&&e("height"),k[i].sizeWidth&&e("width")}function j(t,i,o,e){function n(){var e,n;k[o]?.postMessageTarget?({postMessageTarget:e,targetOrigin:n}=k[o],M(o,`[${t}] Sending message to iframe[${o}] (${i}) targetOrigin: `+n),e.postMessage(I+i,n)):T(o,`[${t}] IFrame(${o}) not found`)}function r(){e&&k[o]?.warningTimeout&&(k[o].msgTimeout=setTimeout(function(){k[o]?.loaded||a||k[o]!==s&&(a=!0,T(o,`IFrame has not responded within ${k[o].warningTimeout/1e3} seconds. Check iFrameResizer.contentWindow.js has been loaded in iFrame.`+" This message can be ignored if everything is working, or you can set the warningTimeout option to a higher value or zero to suppress this warning."))},k[o].warningTimeout))}let a=!1;k[o]&&(n(),r())}function P(e){var n=k[e];return[e,"8",n.sizeWidth,n.log,"32",n.enablePublicMethods,n.autoResize,n.bodyMargin,n.heightCalculationMethod,n.bodyBackground,n.bodyPadding,n.tolerance,n.inPageLinks,"child",n.widthCalculationMethod,n.mouseEvents,n.offsetHeight,n.offsetWidth].join(":")}const g=e=>!Number.isNaN(e);function r(i,n){function e(t){z(i,"load",function(){var e,n;j("iFrame.onload",t,i.id,!0),e=k[o]?.firstRun,n=k[o]?.heightCalculationMethod in d,!e&&n&&O({iframe:i,height:0,width:0,type:"init"})}),j("init",t,i.id,!0)}function t(e){k[o]={iframe:i,firstRun:!0,remoteHost:i?.src.split("/").slice(0,3).join("/"),...l,...function(e){if(e&&"object"!=typeof e)throw new TypeError("Options is not an object");return e||{}}(e)},null===k[o].postMessageTarget&&(k[o].postMessageTarget=i.contentWindow),k[o].targetOrigin=!0!==k[o].checkOrigin||""===(e=k[o].remoteHost)||null!==e.match(/^(about:blank|javascript:|file:\/\/)/)?"*":e}const o=function(e){if("string"!=typeof e)throw new TypeError("Invaild id for iFrame. Expected String");return""===e&&(i.id=e=function(){let e=n?.id||l.id+c++;return null!==document.getElementById(e)&&(e+=c++),e}(),u=(n||{}).log,M(e,`Added missing iframe ID: ${e} (${i.src})`)),e}(i.id);if(o in k&&"iFrameResizer"in i)T(o,"Ignored iFrame, already setup.");else{switch(t(n),M(o,`IFrame scrolling ${k[o]?.scrolling?"enabled":"disabled"} for `+o),i.style.overflow=!1===k[o]?.scrolling?"hidden":"auto",k[o]?.scrolling){case"omit":break;case!0:i.scrolling="yes";break;case!1:i.scrolling="no";break;default:i.scrolling=k[o]?k[o].scrolling:"no"}s("Height"),s("Width"),a("maxHeight"),a("minHeight"),a("maxWidth"),a("minWidth"),"number"!=typeof(r=k[o].bodyMargin)&&"0"!==r||(k[o].bodyMargin=r+"px"),e(P(o)),k[o]&&(k[o].iframe.iFrameResizer={close:E.bind(null,k[o].iframe),removeListeners:f.bind(null,k[o].iframe),resize:j.bind(null,"Window resize","resize",o),moveToAnchor(e){j("Move to anchor","moveToAnchor:"+e,o)},sendMessage(e){j("Send Message","message:"+(e=JSON.stringify(e)),o)}})}var r;function a(e){var n=k[o][e];1/0!==n&&0!==n&&(i.style[e]=g(n)?n+"px":n,M(o,`Set ${e} = `+i.style[e]))}function s(e){if(g("min"+e)&&g("max"+e)&&k[o]["min"+e]>k[o]["max"+e])throw new Error(`Value for min${e} can not be greater than max`+e)}}function n(t,i){Object.keys(k).forEach(function(e){var n;n=e,k[n]?.autoResize&&!k[n]?.firstRun&&j(t,i,e)})}function a(){!1===document.hidden&&(M("document","Trigger event: Visibility change"),n("Tab Visible","resize"))}let m=!1;function h(){function t(e,n){if(n){if(!n.tagName)throw new TypeError("Object is not a valid DOM element");if("IFRAME"!==n.tagName.toUpperCase())throw new TypeError(`Expected <IFRAME> tag, found <${n.tagName}>`);r(n,e),i.push(n)}}let i;return m||(z(window,"message",e),z(document,"visibilitychange",a),m=!0),function(e,n){switch(i=[],typeof n){case"undefined":case"string":Array.prototype.forEach.call(document.querySelectorAll(n||"iframe"),t.bind(s,e));break;case"object":t(e,n);break;default:throw new TypeError(`Unexpected data type (${typeof n})`)}return i}}function p(e){e.fn?e.fn.iFrameResize||(e.fn.iFrameResize=function(t){return this.filter("iframe").each(function(e,n){r(n,t)}).end()}):T("","Unable to bind to jQuery, it is not fully loaded.")}window.jQuery!==s&&p(window.jQuery),"function"==typeof define&&define.amd&&define([],h),"object"==typeof module&&"object"==typeof module.exports&&(module.exports=h()),window.iFrameResize=window.iFrameResize||h()}();
//# sourceMappingURL=iframeResizer.map